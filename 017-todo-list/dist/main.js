(()=>{"use strict";class t{constructor(t){this.name=t,this.todos=[]}getName=()=>this.name;setName=t=>this.name=t;getTodos=()=>this.todos;setTodos=t=>this.todos=t;getTodo=t=>this.todos.find((e=>e.getTitle()===t));addTodo=t=>this.todos.push(t);deleteTodo=t=>{this.todos.splice(this.todos.indexOf(t),1)}}class e{constructor(t,e="",o="No due date",d=null,s=!1){this.title=t,this.description=e,this.dueDate=o,this.priority=d,this.isDone=s}getTitle=()=>this.title;setTitle=t=>this.title=t;getDescription=()=>this.description;setDescription=t=>this.description=t;getDueDate=()=>this.dueDate;setDueDate=t=>this.dueDate=t;setPriority=t=>this.priority=t;getPriority=()=>this.priority;setIsDone=t=>this.isDone=t;getIsDone=()=>this.isDone}class o{constructor(){const e=new t("My Todos");this.projects=[],this.projects.push(e)}getProjects=()=>this.projects;setProjects=t=>this.projects=t;getProject=t=>this.projects.find((e=>e.getName()===t));addProject=t=>this.projects.push(t);deleteProject=t=>{const e=this.projects.find((e=>e.getName()===t));this.projects.splice(this.projects.indexOf(e),1)}}class d{static saveTodoList(t){localStorage.setItem("todoList",JSON.stringify(t))}static getTodoList(){const d=Object.assign(new o,JSON.parse(localStorage.getItem("todoList")));return d.setProjects(d.getProjects().map((e=>Object.assign(new t,e)))),d.getProjects().forEach((t=>t.setTodos(t.getTodos().map((t=>Object.assign(new e,t)))))),d}static addProject(t){const e=d.getTodoList();e.addProject(t),d.saveTodoList(e)}static deleteProject(t){const e=d.getTodoList();e.deleteProject(t),d.saveTodoList(e)}static toggleTodoIsDone(t,e){const o=d.getTodoList(),s=o.getProject(t).getTodos().filter((t=>t.getTitle()===e))[0];s.setIsDone(!s.getIsDone()),d.saveTodoList(o)}static deleteTodo(t,e){const o=d.getTodoList();o.getProject(t).deleteTodo(e),d.saveTodoList(o)}static saveTodoForm(t,e,o,s,r,c){const i=d.getTodoList(),n=i.getProject(t).getTodo(e);if(!o)return alert("must provide a title");r||(r="No due date"),n.setTitle(o),n.setPriority(s),n.setDueDate(r),n.setDescription(c),d.saveTodoList(i)}static addTodo(t,o,s,r,c){const i=d.getTodoList();i.getProject(t).addTodo(new e(o,c,r,s)),d.saveTodoList(i)}}class s{static currentProject="My Todos";static loadHome=()=>{if(null===localStorage.getItem("todoList")){const t=d.getTodoList();localStorage.setItem("todoList",JSON.stringify(t))}s.initProjectForm(),s.initTodoForm(),s.loadProjects(),s.initProjects(),s.loadTodos(s.currentProject),s.initTodos()};static initProjectForm(){document.querySelector(".btn-project-form").addEventListener("click",s.toggleAddProjectForm),document.querySelector(".btn-cancel").addEventListener("click",s.toggleAddProjectForm),document.querySelector(".btn-add").addEventListener("click",(t=>s.addProject(t)))}static initTodoForm(){document.querySelector(".btn-add-todo").addEventListener("click",s.toggleAddTodoForm),document.querySelector("#new-todo-save-btn").addEventListener("click",(t=>{t.preventDefault(),s.addTodo()}))}static loadProjects(){document.querySelector(".projects").innerHTML="",d.getTodoList().getProjects().forEach((t=>{s.createProject(t.name)}))}static initProjects(){document.querySelectorAll(".btn-delete-project").forEach((t=>t.addEventListener("click",(t=>{const{name:e}=t.target.dataset;d.deleteProject(e),s.reloadProjects()})))),document.querySelectorAll(".project").forEach((t=>{t.addEventListener("click",(e=>{e.target.classList.contains("btn-delete-project")||s.activateProject(t.dataset.name)}))}))}static loadTodos(t){const e=document.querySelector(".current-project-title");document.querySelector(".todos").textContent="",e.textContent=t,d.getTodoList().getProject(t).getTodos().forEach((t=>{s.createTodo(t)}))}static initTodos(){document.querySelectorAll(".checkbox").forEach((t=>{t.addEventListener("click",(t=>{const e=t.target.parentElement.nextElementSibling.children[0].textContent;d.toggleTodoIsDone(s.currentProject,e),s.reloadTodos()}))})),document.querySelectorAll(".delete-todo").forEach((t=>t.addEventListener("click",(t=>{const e=t.target.dataset.name;d.deleteTodo(s.currentProject,e),s.reloadTodos()})))),document.querySelectorAll(".todo-title").forEach((t=>{const e=t.textContent;t.addEventListener("click",(t=>{s.loadTodoDetails(e)}))}))}static toggleAddProjectForm(){const t=document.querySelector(".form-add-project");t.reset(),t.classList.toggle("show")}static toggleAddTodoForm(){const t=document.querySelector(".form-add-todo");t.reset(),t.classList.toggle("show")}static createProject=t=>{document.querySelector(".projects").innerHTML+=`\n      <li class='project ${s.currentProject===t?"active-project":""}' data-name='${t}'>\n        <div>\n          <i class='fas fa-folder${s.currentProject===t?"-open":""}'></i>\n          <span>${t}</span>\n        </div>\n        <div>\n          <i class='far fa-trash-alt btn-delete-project' data-name='${t}'></i>\n        </div>\n      </li>\n          `};static reloadProjects(){s.loadProjects(),s.initProjects()}static reloadTodos(){s.loadTodos(s.currentProject),s.initTodos()}static addProject(e){e.preventDefault();const o=document.querySelector("#project-name"),r=o.value;o.value="",s.toggleAddProjectForm(),d.getTodoList().getProject(r)?alert("Project with that name already exists"):(d.addProject(new t(r)),s.activateProject(r))}static addTodo(){const t=document.querySelector("#new-todo-title").value,e=document.querySelector("#new-todo-priority").value;let o=document.querySelector("#new-todo-due-date").value;const r=document.querySelector("#new-todo-description").value;o||(o="No due date"),d.addTodo(s.currentProject,t,e,o,r),s.toggleAddTodoForm(),s.reloadTodos()}static activateProject(t){s.currentProject=t,s.reloadProjects(),s.reloadTodos(),s.hideTodoDetails()}static createTodo(t){document.querySelector(".todos").innerHTML+=`\n    <tr class="todo" style='border-left: 5px solid ${"high"===t.priority?"red":"med"===t.priority?"yellow":"green"}'>\n      <td>\n        <i class='far fa-${t.isDone?"check-circle":"circle"} checkbox'></i>\n      </td>\n      <td>\n      <span class='todo-title' ${t.isDone?'style="text-decoration: line-through; font-style: italic"':""}>${t.title}</span>\n      </td>\n      <td>\n        <span class='todo-dueDate'>${t.dueDate}</span>\n      </td>\n      <td>\n        <i class='fas fa-trash-alt delete-todo' data-name='${t.title}'></i>\n      </td>\n    </tr>\n    `}static loadTodoDetails(t){const e=d.getTodoList().getProject(s.currentProject).getTodo(t),o=document.querySelector(".todo-details-form");o.innerHTML="",o.innerHTML=`\n      <label for="todo-title">Title</label>\n      <input id="todo-title" name="todo-title" type="text" value="${e.getTitle()}" />\n      <label for="todo-priority">Priority</label>\n      <select id="todo-priority" name="todo-priority">\n        <option value="low" ${"low"===e.getPriority()?"selected":""}>Low</option>\n        <option value="med" ${"med"===e.getPriority()?"selected":""}>Medium</option>\n        <option value="high" ${"high"===e.getPriority()?"selected":""}>High</option>\n      </select>\n      <label for="todo-due-date">Due Date</label>\n      <input id="todo-due-date" name="todo-due-date" type="date" value="${"No due date"!==e.getDueDate()?e.getDueDate():""}"></input>\n      <label for="todo-description">Description</label>\n      <textarea id="todo-description" name="todo-description">${e.getDescription()}</textarea>\n      <button id="todo-save-btn">Save</button>\n    `;const r=document.querySelector("#todo-save-btn");o.style.display="flex",r.addEventListener("click",(t=>{t.preventDefault(),s.saveTodoForm(e.getTitle()),s.reloadTodos()}))}static saveTodoForm(t){const e=document.querySelector("#todo-title").value,o=document.querySelector("#todo-priority").value;let r=document.querySelector("#todo-due-date").value;const c=document.querySelector("#todo-description").value;d.saveTodoForm(s.currentProject,t,e,o,r,c),s.hideTodoDetails()}static hideTodoDetails(){document.querySelector(".todo-details-form").style.display="none"}}document.body.addEventListener("DOMContentLoaded",s.loadHome())})();